// flags: --allow-natives-syntax

function store(obj, key, val) { obj[key] = val; }

let arg = (function get_arguments() { return arguments; })(); // JS_ARGUMENTS_OBJECT_TYPE
let arr = []; // JSArray

// ic warmup
for (let i = 0; i < 8; i++) { store(arg, 'a', 0); }

// UNINITIALIZED ic
store(arg, 'a', 0);

// map of arg is cached
// MONOMORPHIC ic
store(arg, 'a', 0);

// map of arr is cached
// POLYMORPHIC ic
// arr grows => store mode is STORE_AND_GROW_HANDLE_COW
// StoreFastElementIC_GrowNoTransitionHandleCOW is selected as handler for arg
store(arr, arr.length, 0);
% DebugPrint(store);

// arg grows => filled with hole
// no transition => elements kind of arg is still PACKED_ELEMENTS
% DebugPrint(arg);
store(arg, arg.length, 0);
% DebugPrint(arg);

let hole = arg[arg.length + 1];
% DebugPrint(hole);
