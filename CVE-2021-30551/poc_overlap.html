<!-- flags: --js-flags=--allow-natives-syntax -->

<body>
    <script>
        let embed = document.createElement("embed"); // <embed> has property interceptor
        embed.type = "text/html"; // let embed.onload() is called on append

        let o1 = { __proto__: embed }; // o1: map0
        let o2 = { __proto__: embed }; // o2: map0

        embed.onload = () => {
            // embed.onload() is executed asynchronously
            o1.a = 1; // o1: map1
            o2.a = 1.1; // o2: map2 (map1 is deprecated)
        }
        % SystemBreak();
        document.body.append(embed); // call embed.onload()
        o1.a = 2; // o1: map3 (migrate from map1 which is deprecated)
        % DebugPrint(o1);
    </script>
</body>
